<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Benchtop Hole Positioning</title>
  <link rel="stylesheet" href="style.css?v=20251208-5">

  <!-- Load Excel parser (SheetJS) -->
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js?v=20251208-5"></script>
</head>

<body>
  <!-- ðŸ”‘ Login screen -->
  <div id="login">
    <h2>Enter Password</h2>
    <input type="password" id="password" placeholder="Password">
    <button id="submitBtn">Submit</button>
  </div>

  <!-- ðŸ”’ Protected content (your existing app) -->
  <div id="protected" style="display:none;">
    <h1>The Workbench</h1>

    <div class="layout">
      <!-- Left column: controls -->
      <div class="left-column">
        <div class="panel">
          <h3>Benchtop Setup</h3>
          <label for="sizeSelect">Size:</label>
          <select id="sizeSelect">
            <option value="600">600mm x 465mm</option>
            <option value="750">750mm x 465mm</option>
            <option value="900">900mm x 465mm</option>
            <option value="1200">1200mm x 465mm</option>
            <option value="1500">1500mm x 465mm</option>
            <option value="1800">1800mm x 465mm</option>
          </select>
          <label>
            <input type="checkbox" id="doubleMode" style="display:none">
            Double
          </label>
        </div>
        <div class="panel">
          <h3>Placement</h3>
          <div class="button-row">
            <button id="placeTapBtn">Place Tap Hole</button>
            <button id="placeWasteBtn">Place Waste Hole</button>
            <button id="placeTap2Btn" style="display:none">Place Tap Hole 2</button>
            <button id="placeWaste2Btn" style="display:none">Place Waste Hole 2</button>
            <button id="lockBtn" class="toggle" title="Lock tap and waste holes together so they move as one">
              Lock Holes
            </button>
          </div>
          <label>
            <input type="checkbox" id="showMeasurementArrow">
            Show measurement arrow
          </label>
        </div>

        <div id="fienzaPanel" class="panel">
          <div class="form-row">
            <label for="fienzaSelect">Basin model:</label>
            <select id="fienzaSelect"></select>
          </div>
          <div class="form-row">
            <label for="tapPosition">Tap position:</label>
            <select id="tapPosition">
              <option value="12">12 oâ€™clock</option>
              <option value="10">10 oâ€™clock</option>
              <option value="2">2 oâ€™clock</option>
            </select>
          </div>
        </div>

        <div class="panel" id="manualHolePanel" style="display:none;">
          <h3>Manual Hole Positioning (mm)</h3>

          <!-- Tap Hole -->
          <fieldset class="hole-group">
            <legend>Tap Hole</legend>
            <div class="input-row">
              <label for="tapX">X:</label>
              <input type="number" id="tapX" step="1">
              <label for="tapY">Y:</label>
              <input type="number" id="tapY" step="1">
              <button onclick="App.clearTaphole1()">Clear</button>
            </div>
          </fieldset>

          <!-- Waste Hole -->
          <fieldset class="hole-group">
            <legend>Waste Hole</legend>
            <div class="input-row">
              <label for="wasteX">X:</label>
              <input type="number" id="wasteX" step="1">
              <label for="wasteY">Y:</label>
              <input type="number" id="wasteY" step="1">
              <button onclick="App.clearWastehole1()">Clear</button>
            </div>
          </fieldset>

          <!-- Tap 2 Hole -->
          <fieldset class="hole-group" id="tap2Fields" style="display:none;">
            <legend>Tap 2 Hole</legend>
            <div class="input-row">
              <label for="tap2X">X:</label>
              <input type="number" id="tap2X" step="1">
              <label for="tap2Y">Y:</label>
              <input type="number" id="tap2Y" step="1">
              <button onclick="App.clearTaphole2()">Clear</button>
            </div>
          </fieldset>

          <!-- Waste 2 Hole -->
          <fieldset class="hole-group" id="waste2Fields" style="display:none;">
            <legend>Waste 2 Hole</legend>
            <div class="input-row">
              <label for="waste2X">X:</label>
              <input type="number" id="waste2X" step="1">
              <label for="waste2Y">Y:</label>
              <input type="number" id="waste2Y" step="1">
              <button onclick="App.clearWastehole2()">Clear</button>
            </div>
          </fieldset>

          <!-- Waste Hole Diameter -->
          <div class="input-row">
            <label for="wasteSize">Waste Hole Diameter:</label>
            <select id="wasteSize">
              <option value="70">70mm</option>
              <option value="80">80mm</option>
              <option value="90">90mm</option>
              <option value="100">100mm</option>
            </select>
          </div>

          <!-- Clear All -->
          <div class="button-row">
            <button onclick="App.clearAll()">Clear All</button>
          </div>
        </div>


        <div class="panel custom-basin-panel">
          <h3>Custom Basin (optional)</h3>

          <!-- Shape selector -->
          <div class="form-row">
            <label for="basinShape">Shape:</label>
            <select id="basinShape">
              <option value="">None</option>
              <option value="circle">Circle</option>
              <option value="square">Square</option>
              <option value="rect">Rectangle</option>
            </select>
          </div>

          <!-- Basin size (injected dynamically) -->
          <div id="basinSizeInputs" class="form-row" style="display: none;"></div>

          <!-- Basin position (stacked layout) -->
          <div id="basinPositionGroup" class="form-stack" style="display: none;">
            <div class="stack-row">
              <label for="basinX">Basin X:</label>
              <input type="number" id="basinX" step="1">
            </div>
            <div class="stack-row">
              <label for="basinY">Basin Y:</label>
              <input type="number" id="basinY" step="1">
            </div>
          </div>

          <!-- Corner radius -->
          <div id="cornerRadiusFields" class="form-row" style="display: none;">
            <label for="cornerRadius">Corner radius (mm):</label>
            <input type="range" id="cornerRadius" min="0" max="100" step="1" value="0">
            <input type="number" id="cornerRadiusValue" min="0" max="100" step="1" value="0">
            <span id="cornerRadiusMaxLabel" class="max-label"></span>
          </div>

          <!-- Clear button -->
          <div class="button-row">
            <button onclick="App.clearBasin()">Clear Basin</button>
          </div>
        </div>

        <div class="panel button-row">
          <button class="export" onclick="ExportTools.downloadPDF()">Export PDF</button>
          <button class="export" onclick="ExportTools.downloadImage()">Save Image</button>
        </div>
      </div>

      <!-- Right column: canvas + report -->
      <div class="right-column">
        <!-- âœ… Export area wrapper -->
        <div id="exportArea">
          <canvas id="benchtopCanvas" width="1000" height="300"></canvas>
          <div class="report" id="report"></div>
        </div>
      </div>

      <!-- ðŸ”‘ Password gate script -->
      <script>
        const PASSWORD = "letmein"; // change this to your demo password

        document.getElementById("submitBtn").addEventListener("click", () => {
          const input = document.getElementById("password").value;
          if (input === PASSWORD) {
            document.getElementById("login").style.display = "none";
            document.getElementById("protected").style.display = "block";
          } else {
            alert("Incorrect password");
          }
        });
      </script>

      <!-- Main app logic -->
      <script type="module" src="./js/main.js?v=20251208-5"></script>
      <script type="module" src="./js/fienza.js?v=20251208-5"></script>
      <script type="module" src="./js/canvas.js?v=20251208-5"></script>
      <script type="module" src="./js/app.js?v=20251208-5"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js?v=20251208-5"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js?v=20251208-5"></script>
      <script type="module" src="./js/export.js?v=20251208-5"></script>
</body>

</html>